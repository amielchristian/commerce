{% extends "auctions/layout.html" %}

{% block body %}
    <h2>Listing: {{ listing.name }}</h2>
    <img src="/static/auctions/{{ listing.image_name }}" alt="Image of {{ listing.name }}">
    <p>{{ listing.description }}</p>
    <h4>${{ listing.highest_bid }}</h4>

    <form method="POST" action="{% url 'listing' listing_id=listing_id %}">
        {% csrf_token %}
        {{ bid_form }}
    </form>
    {% if listing.highest_bidder == "0" %}
        <p>No bids yet.</p>
    {% else %}
        <p>
            {{ bid_amount }}
            {% if bid_amount == 1 %}
                bid
            {% else %}
                bids
            {% endif %}
            placed. 
            
            {% if listing.highest_bidder == user %}
                Your bid is the current highest bid.
            {% endif %}
        </p>
    {% endif %}

    <form method="POST" action="{% url 'listing' listing_id=listing_id %}">
        {% csrf_token %}
        {% if in_watchlist %}
            <input name="remove" type="submit" value="Remove from Watchlist"/>
        {% else %}
            <input name="add" type="submit" value="Add to Watchlist"/>
        {% endif %}
    </form>

    <hr>
    
    <h4>Details</h4>
    <ul>
        <li>Listed by: {{ listing.lister }}</li>
        <li>Category: {{ listing.category }}</li>
        <li>Placed at: {{ listing.time }}</li>
        <li>Starting price: ${{ listing.start_price }}</li>
        <li>Active: {{ listing.is_active }}</li>
    </ul>
    <hr>

    <h4>Comments</h4>
    <form method="POST" action="{% url 'listing' listing_id=listing_id %}">
        {% csrf_token %}
        {{ comment_form }}
        <br>
        <input type="submit">
    </form>
    {% for comment in comments %}
        <div>
            {{ comment.commenter }}:
            {{ comment.comment }}
            {{ comment.time }}
        </div>
        <br>
    {% endfor %}
{% endblock %}